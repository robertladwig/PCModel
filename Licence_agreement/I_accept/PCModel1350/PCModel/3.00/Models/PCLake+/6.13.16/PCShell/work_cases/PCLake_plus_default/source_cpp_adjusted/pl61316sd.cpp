dDepthW = IF (aInclStrat EQ TRUE) THEN vDeltaWEpi + vDeltaW + vDeltaWHyp + vDredDepthW ELSE 0.0 + vDeltaWEpi + vDeltaW + vDredDepthW ENDIF ;
dMixDepthW = vTranHypEpiW;
dNH4WHyp = ( wNTranNH4WHyp + wNAbioNH4WHyp + wNPrimNH4WHyp + wNBedNH4WHyp + wNWebNH4WHyp + uNBackLoadHyp / uDepthWHyp - aRelDeltaWHyp * oNH4WHyp - wNExchNH4Hyp - wNExchNH4WHyp  - wNAdvNH4W / uDepthWHyp ) * MassHyp;
dNO3WHyp = ( wNTranNO3WHyp + wNAbioNO3WHyp + wNPrimNO3WHyp + wNBedNO3WHyp + wNWebNO3WHyp - aRelDeltaWHyp * oNO3WHyp - wNExchNO3Hyp - wNExchNO3WHyp  - wNAdvNO3W / uDepthWHyp ) * MassHyp;
dPO4WHyp = ( wPTranPO4WHyp + wPAbioPO4WHyp + wPPrimPO4WHyp + wPBedPO4WHyp + wPWebPO4WHyp + uPBackLoadHyp / uDepthWHyp - aRelDeltaWHyp * oPO4WHyp - wPExchPO4Hyp - wPExchPO4WHyp  - wPAdvPO4W / uDepthWHyp ) * MassHyp;
dPAIMWHyp = ( wPTranAIMWHyp + wPAbioAIMWHyp - aRelDeltaWHyp * oPAIMWHyp - wPExchAIMHyp - wPExchAIMWHyp  - wPAdvAIMW / uDepthWHyp ) * MassHyp;
dSiO2WHyp = ( wSiTranSiO2Hyp + wSiAbioSiO2WHyp + wSiPrimSiO2WHyp - aRelDeltaWHyp * oSiO2WHyp - wSiExchSiO2Hyp - wSiExchSiO2WHyp  - wSiAdvSiO2W / uDepthWHyp ) * MassHyp;
dO2WHyp = ( wO2TranWHyp + wO2AbioWHyp + wO2PrimWHyp - tO2PrimSHyp + tO2BedWHyp / uDepthWHyp - aRelDeltaWHyp* oO2WHyp - wO2ExchHyp - wO2ExchWHyp  - wO2AdvW / uDepthWHyp ) * MassHyp;
dDDetWHyp = ( wDTranDetWHyp + wDAbioDetWHyp + wDPrimDetWHyp + wDBedDetWHyp + wDWebDetWHyp - aRelDeltaWHyp * oDDetWHyp - wDExchDetHyp - wDExchDetWHyp  - wDAdvDetW / uDepthWHyp ) * MassHyp;
dNDetWHyp = ( wNTranDetWHyp + wNAbioDetWHyp + wNPrimDetWHyp + wNBedDetWHyp + wNWebDetWHyp -aRelDeltaWHyp * oNDetWHyp - wNExchDetHyp - wNExchDetWHyp  - wNAdvDetW / uDepthWHyp ) * MassHyp;
dPDetWHyp = ( wPTranDetWHyp + wPAbioDetWHyp + wPPrimDetWHyp + wPBedDetWHyp + wPWebDetWHyp - aRelDeltaWHyp * oPDetWHyp - wPExchDetHyp - wPExchDetWHyp  - wPAdvDetW / uDepthWHyp ) * MassHyp;
dSiDetWHyp = ( wSiTranDetWHyp + wSiAbioDetWHyp + wSiPrimDetWHyp + wSiWebDetWHyp - aRelDeltaWHyp * oSiDetWHyp - wSiExchDetHyp - wSiExchDetWHyp  - wSiAdvDetW / uDepthWHyp ) * MassHyp;
dDIMWHyp = ( wDTranIMWHyp + wDAbioIMWHyp - aRelDeltaWHyp * oDIMWHyp - wDExchIMHyp - wDExchIMWHyp  - wDAdvIMW / uDepthWHyp ) * MassHyp;
dDDiatWHyp = ( wDTranDiatHyp + wDPrimDiatWHyp + wDWebDiatWHyp - aRelDeltaWHyp * oDDiatWHyp - wDExchDiatHyp - wDExchDiatWHyp  - wDAdvDiatW / uDepthWHyp ) * MassHyp;
dNDiatWHyp = ( wNTranDiatHyp + wNPrimDiatWHyp + wNWebDiatWHyp -aRelDeltaWHyp * oNDiatWHyp - wNExchDiatHyp - wNExchDiatWHyp  - wNAdvDiatW / uDepthWHyp ) * MassHyp;
dPDiatWHyp = ( wPTranDiatHyp + wPPrimDiatWHyp + wPWebDiatWHyp -aRelDeltaWHyp * oPDiatWHyp - wPExchDiatHyp - wPExchDiatWHyp  - wPAdvDiatW / uDepthWHyp ) * MassHyp;
dDGrenWHyp = ( wDTranGrenHyp + wDPrimGrenWHyp + wDWebGrenWHyp - aRelDeltaWHyp* oDGrenWHyp - wDExchGrenHyp - wDExchGrenWHyp  - wDAdvGrenW / uDepthWHyp ) * MassHyp;
dNGrenWHyp = ( wNTranGrenHyp + wNPrimGrenWHyp + wNWebGrenWHyp - aRelDeltaWHyp * oNGrenWHyp - wNExchGrenHyp - wNExchGrenWHyp  - wNAdvGrenW / uDepthWHyp ) * MassHyp;
dPGrenWHyp = ( wPTranGrenHyp + wPPrimGrenWHyp + wPWebGrenWHyp - aRelDeltaWHyp * oPGrenWHyp - wPExchGrenHyp - wPExchGrenWHyp  - wPAdvGrenW / uDepthWHyp ) * MassHyp;
dDBlueWHyp = ( wDTranBlueHyp + wDPrimBlueWHyp + wDWebBlueWHyp - aRelDeltaWHyp* oDBlueWHyp - wDExchBlueHyp - wDExchBlueWHyp  - wDAdvBlueW / uDepthWHyp ) * MassHyp;
dNBlueWHyp = ( wNTranBlueHyp + wNPrimBlueWHyp + wNWebBlueWHyp - aRelDeltaWHyp * oNBlueWHyp - wNExchBlueHyp - wNExchBlueWHyp  - wNAdvBlueW / uDepthWHyp ) * MassHyp;
dPBlueWHyp = ( wPTranBlueHyp + wPPrimBlueWHyp + wPWebBlueWHyp -aRelDeltaWHyp * oPBlueWHyp - wPExchBlueHyp - wPExchBlueWHyp  - wPAdvBlueW / uDepthWHyp ) * MassHyp;
dDZooHyp = ( wDTranZooHyp + wDWebZooHyp - aRelDeltaWHyp * oDZooHyp - wDExchZooHyp - wDExchZooWHyp  - wDAdvZooW / uDepthWHyp ) * MassHyp;
dNZooHyp = ( wNTranZooHyp + wNWebZooHyp -aRelDeltaWHyp * oNZooHyp - wNExchZooHyp - wNExchZooWHyp  - wNAdvZooW / uDepthWHyp ) * MassHyp;
dPZooHyp = ( wPTranZooHyp + wPWebZooHyp - aRelDeltaWHyp * oPZooHyp - wPExchZooHyp - wPExchZooWHyp  - wPAdvZooW / uDepthWHyp ) * MassHyp;
dDFiAd = tDWebFiAd;
dDFiJv = tDWebFiJv;
dNFiAd = tNWebFiAd;
dNFiJv = tNWebFiJv;
dPFiAd = tPWebFiAd;
dPFiJv = tPWebFiJv;
dDPisc = tDWebPisc;
dNH4S = tNAbioNH4S - tNBurNH4 + tNPrimNH4S + tNBedNH4S + tNWebNH4S;
dNO3S = tNAbioNO3S - tNBurNO3 + tNPrimNO3S + tNBedNO3S + tNWebNO3S;
dPO4S = tPAbioPO4S - tPBurPO4 + tPPrimPO4S + tPBedPO4S + tPWebPO4S;
dPAIMS = tPAbioAIMS - tPBurAIM - tPDredAIMS;
dDDetS = tDAbioDetS - tDBurDet + tDPrimDetS + tDBedDetSEpi + tDBedDetSHyp + tDWebDetS - tDDredDetS;
dNDetS = tNAbioDetS - tNBurDet + tNPrimDetS + tNBedDetS + tNWebDetS - tNDredDetS;
dPDetS = tPAbioDetS - tPBurDet + tPPrimDetS + tPBedDetS + tPWebDetS - tPDredDetS;
dSiDetS = tSiAbioDetS - tSiBurDet + tSiPrimDetS + tSiWebDetS - tSiDredDetS;
dDHumS = tDAbioHumS - tDBurHum - tDDredNetHumS;
dNHumS = tNAbioHumS - tNBurHum - tNDredNetHumS;
dPHumS = tPAbioHumS - tPBurHum - tPDredNetHumS;
dDIMS = tDAbioIMS - tDBurIM - tDDredNetIMS;
dDDiatS= tDPrimDiatS + tDWebDiatS - tDDredDiatS;
dNDiatS= tNPrimDiatS + tNWebDiatS - tNDredDiatS;
dPDiatS= tPPrimDiatS + tPWebDiatS - tPDredDiatS;
dDGrenS= tDPrimGrenS + tDWebGrenS - tDDredGrenS;
dNGrenS= tNPrimGrenS + tNWebGrenS - tPDredGrenS;
dPGrenS= tPPrimGrenS + tPWebGrenS - tPDredGrenS;
dDBlueS= tDPrimBlueS + tDWebBlueS - tDDredBlueS;
dNBlueS= tNPrimBlueS + tNWebBlueS - tNDredBlueS;
dPBlueS=tPPrimBlueS + tPWebBlueS - tPDredBlueS;
dDVeg = tDBedVeg - tDDredVeg;
dNVeg = tNBedVeg - tNDredVeg;
dPVeg = tPBedVeg - tPDredVeg;
dVegHeight =  IF ( aVegWin EQ 1 AND  uVegHeight LT MIN (cVegHeightWin, uDepthW) ) THEN  MIN ( cVegHeightWin - uVegHeight , ( MIN (uDepthW , MAX ( cVegHeightWin , cVegHeight) ) -  MIN ( cVegHeightWin , cVegHeight , uDepthW) ) / cLengAllo) ELSEIF ( aVegWin EQ 1 AND  uVegHeight GT MIN (cVegHeightWin, uDepthW) ) THEN MAX (cVegHeightWin - uVegHeight , ( MIN ( cVegHeightWin , cVegHeight , uDepthW) - MIN (uDepthW , MAX ( cVegHeightWin , cVegHeight) ) ) / cLengMort) ELSEIF ( aVegWin EQ 0 AND  uVegHeight LT MIN (cVegHeight, uDepthW) ) THEN  MIN ( cVegHeight - uVegHeight , ( MIN (uDepthW , MAX ( cVegHeightWin , cVegHeight) ) -  MIN ( cVegHeightWin , cVegHeight , uDepthW) ) / cLengAllo) ELSEIF ( aVegWin EQ 0 AND  uVegHeight GT MIN (cVegHeight, uDepthW) ) THEN MAX ( uVegHeight -  cVegHeight, ( MIN ( cVegHeightWin , cVegHeight , uDepthW) - MIN (uDepthW , MAX ( cVegHeightWin , cVegHeight) ) ) / cLengMort) ELSE 0.0 ENDIF;
dDBent = tDWebBent - tDDredBent;
dNBent = tNWebBent - tNDredBent;
dPBent = tPWebBent - tPDredBent;
dDepthWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN vTranDepthW + vDeltaWM ELSE 0.0 ENDIF;
dNH4WM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( tNDifNH4M/uDepthWM - wNNitrWM + wNMinDetWM - tNEvNH4WM/uDepthWM - tNInfNH4WM/uDepthWM + tNSeepNH4WM/uDepthWM + wNExchNH4MEpi + wNExchNH4MHyp - aRelDeltaWM * oNH4WM + wNAdvNH4WM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNO3WM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( tNDifNO3M/uDepthWM + wNNitrWM - wNDenitWM - tNEvNO3WM/uDepthWM - tNInfNO3WM/uDepthWM + tNSeepNO3WM/uDepthWM + wNExchNO3MEpi + wNExchNO3MHyp- aRelDeltaWM * oNO3WM + wNAdvNO3WM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPO4WM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( - tPInfPO4WM / uDepthWM + tPSeepPO4WM / uDepthWM + tPDifPO4M / uDepthWM + wPMinDetWM - tPEvPO4WM / uDepthWM - wPSorpIMWM + wPExchPO4MEpi + wPExchPO4MHyp - aRelDeltaWM * oPO4WM + wPAdvPO4WM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPAIMWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( - tPSetAIMM / uDepthWM + wPSorpIMWM + wPExchAIMMEpi+ wPExchAIMMHyp - aRelDeltaWM * oPAIMWM + wPAdvAIMWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dSiO2WM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wSiMinDetWM + tSiMinDetSM / uDepthWM + wSiExchSiO2MEpi + wSiExchSiO2MHyp- aRelDeltaWM * oSiO2WM + wSiAdvSiO2WM/uDepthWM - tInfSiO2WM /uDepthWM + tSeepSiO2WM /uDepthWM) * MassWM ELSE 0.0 ENDIF;
dO2WM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wO2AbioM + wO2ExchMEpi + wO2ExchMHyp - aRelDeltaWM * oO2WM - tO2FlowPhra / uDepthWM + wO2AdvWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDDetWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( tDMortShootPhra/uDepthWM - tDSetDetM/uDepthWM - wDMinDetWM + wDExchDetMEpi + wDExchDetMHyp- aRelDeltaWM * oDDetWM + wDAdvDetWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNDetWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( tNMortShootPhra / uDepthWM - tNSetDetM / uDepthWM - wNMinDetWM + wNExchDetMEpi + wNExchDetMHyp - aRelDeltaWM * oNDetWM + wNAdvDetWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPDetWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( tPMortShootPhra / uDepthWM - tPSetDetM / uDepthWM - wPMinDetWM + wPExchDetMEpi + wPExchDetMHyp - aRelDeltaWM * oPDetWM + wPAdvDetWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dSiDetWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( - tSiSetDetM / uDepthWM - wSiMinDetWM + wSiExchDetMEpi + wSiExchDetMHyp - aRelDeltaWM * oSiDetWM + wSiAdvDetWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDIMWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( - tDSetIMM/uDepthWM + wDExchIMMEpi + wDExchIMMHyp - aRelDeltaWM * oDIMWM + wDAdvIMWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDDiatWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wDExchDiatMEpi +wDExchDiatMHyp - tDSetDiatM / uDepthWM - aRelDeltaWM * oDDiatWM + wDAdvDiatWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNDiatWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wNExchDiatMEpi + wNExchDiatMHyp - tNSetDiatM / uDepthWM - aRelDeltaWM * oNDiatWM + wNAdvDiatWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPDiatWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wPExchDiatMEpi +wPExchDiatMHyp - tPSetDiatM / uDepthWM - aRelDeltaWM * oPDiatWM + wPAdvDiatWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDGrenWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wDExchGrenMEpi + wDExchGrenMHyp- tDSetGrenM / uDepthWM - aRelDeltaWM * oDGrenWM + wDAdvGrenWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNGrenWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wNExchGrenMEpi + wNExchGrenMHyp - tNSetGrenM / uDepthWM - aRelDeltaWM * oNGrenWM + wNAdvGrenWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPGrenWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wPExchGrenMEpi + wPExchGrenMHyp - tPSetGrenM / uDepthWM - aRelDeltaWM * oPGrenWM + wPAdvGrenWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDBlueWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wDExchBlueMEpi + wDExchBlueMHyp- tDSetBlueM / uDepthWM - aRelDeltaWM * oDBlueWM + wDAdvBlueWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNBlueWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wNExchBlueMEpi + wNExchBlueMHyp - tNSetBlueM / uDepthWM - aRelDeltaWM * oNBlueWM + wNAdvBlueWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPBlueWM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wPExchBlueMEpi + wPExchBlueMHyp - tPSetBlueM / uDepthWM - aRelDeltaWM * oPBlueWM + wPAdvBlueWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dDZooM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wDExchZooMEpi + wDExchZooMHyp - aRelDeltaWM * oDZooM + wDAdvZooWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNZooM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wNExchZooMEpi + wNExchZooMHyp - aRelDeltaWM * oNZooM + wNAdvZooWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dPZooM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN ( wPExchZooMEpi + wPExchZooMHyp - aRelDeltaWM * oPZooM + wPAdvZooWM/uDepthWM) * MassWM ELSE 0.0 ENDIF;
dNH4SM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tNInfNH4WM - tNSeepNH4WM - tNInfNH4SM + tNSeepNH4SM +(1.0-fRefrDetS) * tNMinDetSM + tNMinHumSM - tNDifNH4M - tNDifGroundNH4M - tNNitrSM - tNBurNH4M - tNUptNH4PhraS + tNEvNH4WM ELSE 0.0 ENDIF;
dNO3SM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tNInfNO3WM - tNSeepNO3WM - tNInfNO3SM + tNSeepNO3SM + tNNitrSM - tNDenitSM - tNDifNO3M - tNDifGroundNO3M - tNBurNO3M - tNUptNO3PhraS + tNEvNO3WM ELSE 0.0 ENDIF;
dPO4SM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tPInfPO4WM - tPSeepPO4WM- tPInfPO4SM + tPSeepPO4SM + tPEvPO4WM +(1.0-fRefrDetS) * tPMinDetSM + tPMinHumSM - tPSorpIMSM - tPDifPO4M - tPDifGroundPO4M - tPChemPO4M - tPUptPhraS - tPBurPO4M ELSE 0.0 ENDIF;
dPAIMSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tPSetAIMM - tPBurAIMM + tPSorpIMSM ELSE 0.0 ENDIF;
dDDetSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tDMortRootPhra + tDSetDetM - tDMinDetSM + tDSetPhytM - tDBurDetM ELSE 0.0 ENDIF;
dNDetSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tNMortRootPhra + tNSetDetM - tNMinDetSM + tNSetPhytM - tNBurDetM ELSE 0.0 ENDIF;
dPDetSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tPMortRootPhra + tPSetDetM - tPMinDetSM + tPSetPhytM - tPBurDetM ELSE 0.0 ENDIF;
dSiDetSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tSiSetDetM - tSiMinDetSM + cSiDDiat * tDSetDiatM - tSiBurDetM ELSE 0.0 ENDIF;
dDHumSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN fRefrDetS * tDMinDetSM - tDMinHumSM - tDBurHumM ELSE 0.0 ENDIF;
dNHumSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN fRefrDetS * tNMinDetSM - tNMinHumSM - tNBurHumM ELSE 0.0 ENDIF;
dPHumSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN fRefrDetS * tPMinDetSM - tPMinHumSM - tPBurHumM ELSE 0.0 ENDIF;
dDIMSM = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tDSetIMM - tDBurIMM ELSE 0.0 ENDIF;
dDRootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tDProdRootPhra - tDRespRootPhra - tDMortRootPhra - tDAllPhra + tDRealPhra ELSE 0.0 ENDIF;
dDShootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tDProdShootPhra - tDRespShootPhra - tDMortShootPhra + tDAllPhra - tDRealPhra - tDManShootPhra ELSE 0.0 ENDIF;
dNRootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tNUptRootPhra - tNMortRootPhra - tNTransPhra + tNRetrPhra ELSE 0.0 ENDIF;
dNShootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tNUptShootPhra - tNMortShootPhra + tNTransPhra - tNRetrPhra - tNManShootPhra ELSE 0.0 ENDIF;
dPRootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tPUptRootPhra - tPMortRootPhra - tPTransPhra + tPRetrPhra ELSE 0.0 ENDIF;
dPShootPhra = IF (InclMarsh EQ TRUE AND fMarsh GT NearZero) THEN tPUptShootPhra - tPMortShootPhra + tPTransPhra - tPRetrPhra - tPManShootPhra ELSE 0.0 ENDIF;
dNH4WEpi = ( wNTranNH4WEpi + wNAbioNH4WEpi + wNPrimNH4WEpi + wNBedNH4WEpi + wNWebNH4WEpi + cNBackLoad / uDepthWEpi - aRelDeltaWEpi * oNH4WEpi - wNExchNH4Epi + wNExchNH4WEpi  + wNAdvNH4W / uDepthWEpi  - wNAdvNH4WM/uDepthWM * afVolMarshEpi) * MassEpi;
dNO3WEpi = ( wNTranNO3WEpi + wNAbioNO3WEpi + wNPrimNO3WEpi + wNBedNO3WEpi + wNWebNO3WEpi - aRelDeltaWEpi * oNO3WEpi - wNExchNO3Epi + wNExchNO3WEpi  + wNAdvNO3W / uDepthWEpi  - wNAdvNO3WM/uDepthWM * afVolMarshEpi) * MassEpi;
dPO4WEpi = ( wPTranPO4WEpi + wPAbioPO4WEpi + wPPrimPO4WEpi + wPBedPO4WEpi + wPWebPO4WEpi + cPBackLoad / uDepthWEpi - aRelDeltaWEpi * oPO4WEpi - wPExchPO4Epi + wPExchPO4WEpi  + wPAdvPO4W / uDepthWEpi  - wPAdvPO4WM/uDepthWM * afVolMarshEpi) * MassEpi;
dPAIMWEpi = ( wPTranAIMWEpi + wPAbioAIMWEpi - aRelDeltaWEpi * oPAIMWEpi - wPExchAIMEpi + wPExchAIMWEpi  + wPAdvAIMW / uDepthWEpi  - wPAdvAIMWM/uDepthWM * afVolMarshEpi) * MassEpi;
dSiO2WEpi = ( wSiTranSiO2Epi + wSiAbioSiO2WEpi + wSiPrimSiO2WEpi - aRelDeltaWEpi * oSiO2WEpi - wSiExchSiO2Epi + wSiExchSiO2WEpi  + wSiAdvSiO2W / uDepthWEpi  - wSiAdvSiO2WM/uDepthWM * afVolMarshEpi) * MassEpi;
dO2WEpi = ( wO2TranWEpi + wO2AbioWEpi + wO2PrimWEpi -tO2PrimSEpi + tO2BedWEpi / uDepthWEpi - aRelDeltaWEpi * oO2WEpi - wO2ExchEpi + wO2ExchWEpi  + wO2AdvW / uDepthWEpi  - wO2AdvWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDDetWEpi = ( wDTranDetWEpi + wDAbioDetWEpi + wDPrimDetWEpi + wDBedDetWEpi + wDWebDetWEpi - aRelDeltaWEpi * oDDetWEpi - wDExchDetEpi + wDExchDetWEpi  + wDAdvDetW / uDepthWEpi  - wDAdvDetWM/uDepthWM * afVolMarshEpi) * MassEpi;
dNDetWEpi = ( wNTranDetWEpi + wNAbioDetWEpi + wNPrimDetWEpi + wNBedDetWEpi + wNWebDetWEpi - aRelDeltaWEpi * oNDetWEpi - wNExchDetEpi + wNExchDetWEpi  + wNAdvDetW / uDepthWEpi  - wNAdvDetWM/uDepthWM * afVolMarshEpi) * MassEpi;
dPDetWEpi = ( wPTranDetWEpi + wPAbioDetWEpi + wPPrimDetWEpi + wPBedDetWEpi + wPWebDetWEpi - aRelDeltaWEpi * oPDetWEpi - wPExchDetEpi + wPExchDetWEpi  + wPAdvDetW / uDepthWEpi  - wPAdvDetWM/uDepthWM * afVolMarshEpi) * MassEpi;
dSiDetWEpi = ( wSiTranDetWEpi + wSiAbioDetWEpi + wSiPrimDetWEpi + wSiWebDetWEpi - aRelDeltaWEpi * oSiDetWEpi - wSiExchDetEpi + wSiExchDetWEpi  + wSiAdvDetW / uDepthWEpi  - wSiAdvDetWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDIMWEpi = ( wDTranIMWEpi + wDAbioIMWEpi - aRelDeltaWEpi * oDIMWEpi - wDExchIMEpi + wDExchIMWEpi  + wDAdvIMW / uDepthWEpi  - wDAdvIMWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDDiatWEpi = ( wDTranDiatEpi + wDPrimDiatWEpi + wDWebDiatWEpi - aRelDeltaWEpi * oDDiatWEpi - wDExchDiatEpi + wDExchDiatWEpi  + wDAdvDiatW / uDepthWEpi  - wDAdvDiatWM/uDepthWM * afVolMarshEpi) * MassEpi;
dNDiatWEpi = ( wNTranDiatEpi + wNPrimDiatWEpi + wNWebDiatWEpi - aRelDeltaWEpi * oNDiatWEpi - wNExchDiatEpi + wNExchDiatWEpi  + wNAdvDiatW / uDepthWEpi  - wNAdvDiatWM/uDepthWM * afVolMarshEpi) * MassEpi;
dPDiatWEpi = ( wPTranDiatEpi + wPPrimDiatWEpi + wPWebDiatWEpi - aRelDeltaWEpi * oPDiatWEpi - wPExchDiatEpi + wPExchDiatWEpi  + wPAdvDiatW / uDepthWEpi  - wPAdvDiatWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDGrenWEpi = ( wDTranGrenEpi + wDPrimGrenWEpi + wDWebGrenWEpi - aRelDeltaWEpi * oDGrenWEpi - wDExchGrenEpi + wDExchGrenWEpi  + wDAdvGrenW / uDepthWEpi  - wDAdvGrenWM/uDepthWM * afVolMarshEpi) * MassEpi;
dNGrenWEpi = ( wNTranGrenEpi + wNPrimGrenWEpi + wNWebGrenWEpi - aRelDeltaWEpi * oNGrenWEpi - wNExchGrenEpi + wNExchGrenWEpi  + wNAdvGrenW / uDepthWEpi  - wNAdvGrenWM/uDepthWM * afVolMarshEpi) * MassEpi;
dPGrenWEpi = ( wPTranGrenEpi + wPPrimGrenWEpi + wPWebGrenWEpi - aRelDeltaWEpi * oPGrenWEpi - wPExchGrenEpi + wPExchGrenWEpi  + wPAdvGrenW / uDepthWEpi  - wPAdvGrenWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDBlueWEpi = ( wDTranBlueEpi + wDPrimBlueWEpi + wDWebBlueWEpi - aRelDeltaWEpi * oDBlueWEpi - wDExchBlueEpi + wDExchBlueWEpi  + wDAdvBlueW / uDepthWEpi  - wDAdvBlueWM/uDepthWM * afVolMarshEpi) * MassEpi;
dNBlueWEpi = ( wNTranBlueEpi + wNPrimBlueWEpi + wNWebBlueWEpi - aRelDeltaWEpi * oNBlueWEpi - wNExchBlueEpi + wNExchBlueWEpi  + wNAdvBlueW / uDepthWEpi  - wNAdvBlueWM/uDepthWM * afVolMarshEpi) * MassEpi;
dPBlueWEpi = ( wPTranBlueEpi + wPPrimBlueWEpi + wPWebBlueWEpi - aRelDeltaWEpi * oPBlueWEpi - wPExchBlueEpi + wPExchBlueWEpi  + wPAdvBlueW / uDepthWEpi  - wPAdvBlueWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDZooEpi =  ( wDTranZooEpi + wDWebZooEpi - aRelDeltaWEpi * oDZooEpi - wDExchZooEpi + wDExchZooWEpi  + wDAdvZooW / uDepthWEpi  - wDAdvZooWM/uDepthWM * afVolMarshEpi) * MassEpi;
dNZooEpi =  ( wNTranZooEpi + wNWebZooEpi - aRelDeltaWEpi * oNZooEpi - wNExchZooEpi + wNExchZooWEpi  + wNAdvZooW / uDepthWEpi  - wNAdvZooWM/uDepthWM * afVolMarshEpi) * MassEpi;
dPZooEpi =  ( wPTranZooEpi + wPWebZooEpi - aRelDeltaWEpi * oPZooEpi - wPExchZooEpi + wPExchZooWEpi  + wPAdvZooW / uDepthWEpi  - wPAdvZooWM/uDepthWM * afVolMarshEpi) * MassEpi;
dDBlueSurf =tDTranBlueSurf + tDPrimBlueSurf + tDWebBlueSurf;
dNBlueSurf = tNTranBlueSurf + tNPrimBlueSurf + tNWebBlueSurf;
dPBlueSurf = tPTranBlueSurf + tPPrimBlueSurf + tPWebBlueSurf;
dDExtTotT = (uDLoadEpi + uDLoadHyp) - wDOutflTotEpi*uDepthWEpi - tDDilBlueSurf - wDOutflTotHyp*uDepthWHyp + wDTranZooEpi * uDepthWEpi + wDTranZooHyp * uDepthWHyp - tDBurTot + tDAbioTotT + tDPrimTotT + tDBedTotT + tDWebTotT+ tDMarsTotT - tDDredNetTot - aDRelTotT;
dNExtTotT = (uNLoadEpi + uNLoadHyp) - wNOutflTotEpi * uDepthWEpi  - tNDilBlueSurf- wNOutflTotHyp * uDepthWHyp+ wNTranZooHyp * uDepthWHyp + wNTranZooEpi * uDepthWEpi + cNBackLoad - tNBurTot + tNAbioTotT + tNPrimTotT + tNBedTotT + tNWebTotT + tNMarsTotT - tNDredNetTot - aNRelTotT + tNUptBlueAirSurf + tNUptBlueAirEpi + tNUptBlueAirHyp;
dPExtTotT = (uPLoadEpi + uPLoadHyp) - wPOutflTotHyp * uDepthWHyp  - tPDilBlueSurf - wPOutflTotEpi * uDepthWEpi + wPTranZooHyp * uDepthWHyp + wPTranZooEpi * uDepthWEpi + cPBackLoad - tPBurTot + tPAbioTotT + tPPrimTotT + tPBedTotT + tPWebTotT + tPMarsTotT- tPDredNetTot - aPRelTotT;
dSiExtTotT = (uSiLoadEpi + uSiLoadHyp) - wSiDilTotHyp*uDepthWHyp - wSiDilTotEpi*uDepthWEpi + tSiAbioTotT - tSiBurTot + tSiPrimTotT + tSiMarsTotT - tSiDredTot +tSiWebTotT - aSiRelTotT;
dO2ExtTotT = wO2TranWHyp * uDepthWHyp + wO2TranWEpi * uDepthWEpi + tO2BedWHyp + tO2BedWEpi + wO2PrimWHyp * uDepthWHyp + wO2PrimWEpi * uDepthWEpi + wO2AbioWHyp * uDepthWHyp + wO2AbioWEpi * uDepthWEpi + wO2AbioM* uDepthWM * fMarsh - tO2PrimS - tO2FlowPhra * fMarsh - aO2RelTotT;
dDepthExtTotT = (uQPrec + uQInEpi + uQInHyp + uQInSeep - uQEv - uQOutEpi - uQOutHyp - uQOutCor - uQOutInf) / mmPerm;
